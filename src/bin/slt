#!/usr/bin/env ruby

require 'rubygems'
require 'trollop'
require 'slack-utils'

opts = Trollop::options do
	banner <<-EOS

List (and search) installed Slackware package's times.

Usage:
	slt [options] [search flags] [list of names]
	
	if no flags are used, then all entries are listed
	if no search flags, only names, then those only those matching entries are listed

EOS
	opt :color, "Colorize output", :default => false, :type => :boolean
	opt :epoch, "show time in seconds since 1970-01-01 00:00:00 UTC", :type => :boolean
	opt :pkg, "Package PKGNAME (loose match)", :type => :string
	opt :Version, "Package VERSION (loose match)", :type => :string
	opt :arch, "Package ARCH (exact match)", :type => :string
	opt :build, "Package BUILD (exact match)", :type => :string
	opt :tag, "Package TAG (loose match)", :type => :string
end

# handing through that we are gathering times too
opts[:time] = true

if (opts.keys.grep(/[pkg|Version|arch|build|tag]_given$/).count == 0)
	opts[:all] = true
end

begin
	print_packages_times(build_packages(opts, ARGV), opts[:epoch])
rescue Interrupt
	exit 0
end

